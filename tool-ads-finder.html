<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ads Finder ‚Äì GenzTech</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#0a0e27;color:#fff;display:flex;min-height:100vh;font-size:14px}
.sidebar{width:260px;flex-shrink:0;background:rgba(10,14,39,.95);backdrop-filter:blur(20px);border-right:1px solid rgba(255,255,255,.06);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:40}
.sidebar-logo{padding:20px 20px 16px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;gap:10px;text-decoration:none}
.sidebar-logo img{width:36px;height:36px;border-radius:50%}
.sidebar-logo span{font-size:15px;font-weight:700;letter-spacing:.5px;color:#fff}
.sidebar-logo span em{color:#00d4ff;font-style:normal}
.sidebar-nav{flex:1;padding:12px 0;overflow-y:auto}
.nav-group-label{font-size:10px;font-weight:700;color:rgba(255,255,255,.25);text-transform:uppercase;letter-spacing:1.2px;padding:12px 20px 4px}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 20px;font-size:13.5px;color:rgba(255,255,255,.6);text-decoration:none;transition:all .2s;border-left:2px solid transparent}
.nav-item:hover{color:#fff;background:rgba(255,255,255,.04)}
.nav-item.active{color:#00d4ff;background:rgba(0,212,255,.08);border-left-color:#00d4ff}
.nav-item i{width:18px;text-align:center;font-size:15px}
.nav-sub .nav-item{font-size:12.5px;padding:7px 20px 7px 36px}
.main-content{margin-left:260px;flex:1;display:flex;flex-direction:column;min-height:100vh}
.topbar{padding:14px 28px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between;background:rgba(10,14,39,.8);backdrop-filter:blur(10px);position:sticky;top:0;z-index:30}
.breadcrumb{display:flex;align-items:center;gap:8px;font-size:12.5px;color:rgba(255,255,255,.4)}
.btn{padding:8px 16px;border-radius:8px;border:none;cursor:pointer;font-size:13px;font-weight:600;transition:all .2s;display:inline-flex;align-items:center;gap:6px;text-decoration:none}
.btn-sm{padding:6px 12px;font-size:12px}
.btn-primary{background:linear-gradient(135deg,#1877f2,#0a5dc2);color:#fff}
.btn-primary:hover{opacity:.9;transform:translateY(-1px)}
.btn-outline{background:transparent;color:rgba(255,255,255,.7);border:1px solid rgba(255,255,255,.15)}
.btn-outline:hover{border-color:#1877f2;color:#60a5fa}
.btn-danger{background:rgba(239,68,68,.1);color:#ef4444;border:1px solid rgba(239,68,68,.2)}
.btn-danger:hover{background:rgba(239,68,68,.2)}
/* Search */
.search-section{padding:16px 28px;background:rgba(255,255,255,.02);border-bottom:1px solid rgba(255,255,255,.06)}
.search-row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.adlib-badge{display:flex;align-items:center;gap:6px;background:rgba(24,119,242,.1);border:1px solid rgba(24,119,242,.25);border-radius:8px;padding:6px 12px;font-size:13px;font-weight:700;color:#60a5fa;white-space:nowrap;flex-shrink:0}
.search-wrap{flex:1;min-width:240px;position:relative}
.search-input{width:100%;background:rgba(255,255,255,.07);border:1.5px solid rgba(255,255,255,.12);border-radius:24px;padding:10px 18px 10px 44px;color:#fff;font-size:14px;transition:all .2s}
.search-input:focus{outline:none;border-color:#1877f2;background:rgba(24,119,242,.08);box-shadow:0 0 0 3px rgba(24,119,242,.1)}
.search-input::placeholder{color:rgba(255,255,255,.3)}
.search-icon{position:absolute;left:14px;top:50%;transform:translateY(-50%);color:rgba(255,255,255,.35);font-size:16px;pointer-events:none}
.sel{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:20px;padding:8px 28px 8px 14px;color:#fff;font-size:12.5px;cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='white' opacity='0.4'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 8px center;background-color:rgba(255,255,255,.06)}
.sel:focus{outline:none;border-color:#1877f2}
.sel option{background:#1a2035;color:#fff}
/* Filter */
.filter-bar{display:flex;align-items:center;gap:8px;flex-wrap:wrap;padding:10px 28px;border-bottom:1px solid rgba(255,255,255,.05)}
/* Token banner */
.token-bar{margin:10px 28px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:9px 14px;display:flex;align-items:center;gap:10px}
/* Content */
.content-area{padding:20px 28px;flex:1}
.tab-bar{display:flex;gap:3px;padding:3px;background:rgba(0,0,0,.3);border-radius:10px;margin-bottom:20px;width:fit-content}
.tab-btn{padding:7px 16px;border:none;border-radius:8px;background:transparent;color:rgba(255,255,255,.45);font-size:12.5px;font-weight:600;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:5px}
.tab-btn.active{background:rgba(24,119,242,.15);color:#60a5fa}
.tab-pane{display:none}
.tab-pane.active{display:block}
/* Ad Grid */
.ads-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:16px}
.ad-card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:12px;overflow:hidden;transition:all .2s;display:flex;flex-direction:column}
.ad-card:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(0,0,0,.4);border-color:rgba(255,255,255,.14)}
.ad-card-top{padding:10px 13px;display:flex;align-items:flex-start;justify-content:space-between;border-bottom:1px solid rgba(255,255,255,.05)}
.status-dot{display:inline-flex;align-items:center;gap:4px;font-size:11px;font-weight:700}
.status-dot::before{content:'';width:6px;height:6px;border-radius:50%;display:inline-block}
.status-dot.active{color:#4ade80}.status-dot.active::before{background:#4ade80}
.status-dot.inactive{color:rgba(255,255,255,.35)}.status-dot.inactive::before{background:rgba(255,255,255,.25)}
.ad-meta{font-size:10px;color:rgba(255,255,255,.28);margin-top:2px}
.platforms{display:flex;gap:4px;margin-top:3px}
.pfi{font-size:12px}.pfi.fb{color:#1877f2}.pfi.ig{color:#e1306c}.pfi.wa{color:#25d366}.pfi.ms{color:#0084ff}
.ad-preview{width:100%;height:170px;background:rgba(0,0,0,.35);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;cursor:pointer}
.ad-preview:hover .preview-ov{opacity:1}
.preview-ov{position:absolute;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;opacity:0;transition:.2s}
.preview-ov i{font-size:30px;color:#fff}
.preview-ph{color:rgba(255,255,255,.1);display:flex;flex-direction:column;align-items:center;gap:5px;font-size:28px}
.preview-ph span{font-size:11px;color:rgba(255,255,255,.15)}
.ad-body{padding:11px 13px;flex:1}
.page-row{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.page-av{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,#1877f2,#0a5dc2);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;flex-shrink:0}
.page-nm{font-size:13px;font-weight:700;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.page-nm a{color:#fff;text-decoration:none}
.page-nm a:hover{color:#60a5fa}
.page-sub{font-size:10.5px;color:rgba(255,255,255,.35)}
.ad-text{font-size:12.5px;color:rgba(255,255,255,.6);line-height:1.55;margin-bottom:9px;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}
.link-box{background:rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.07);border-radius:7px;padding:8px 10px;margin-bottom:9px}
.link-domain{font-size:10px;color:rgba(255,255,255,.28);text-transform:uppercase;margin-bottom:1px}
.link-title{font-size:12px;font-weight:600;color:rgba(255,255,255,.75)}
.link-desc{font-size:11px;color:rgba(255,255,255,.38);margin-top:1px}
.ad-stats{display:flex;gap:8px;margin-bottom:8px}
.stat-chip{background:rgba(255,255,255,.05);border-radius:6px;padding:4px 8px;font-size:10.5px;color:rgba(255,255,255,.5)}
.stat-chip strong{color:rgba(255,255,255,.8);font-size:11px}
.ad-footer{display:flex;gap:5px;padding:8px 13px;border-top:1px solid rgba(255,255,255,.05)}
.adbtn{flex:1;padding:6px;border-radius:7px;border:none;cursor:pointer;font-size:11px;font-weight:600;transition:.2s;display:flex;align-items:center;justify-content:center;gap:3px;text-decoration:none}
.adbtn-save{background:rgba(251,146,60,.08);color:#fb923c}.adbtn-save:hover{background:rgba(251,146,60,.18)}
.adbtn-save.saved{background:rgba(74,222,128,.08);color:#4ade80}
.adbtn-view{background:rgba(24,119,242,.08);color:#60a5fa}.adbtn-view:hover{background:rgba(24,119,242,.18)}
.adbtn-lib{background:rgba(255,255,255,.06);color:rgba(255,255,255,.6)}.adbtn-lib:hover{background:rgba(255,255,255,.1);color:#fff}
/* States */
.spinner-wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:14px;color:rgba(255,255,255,.4)}
.spinner{width:36px;height:36px;border:3px solid rgba(255,255,255,.08);border-top-color:#1877f2;border-radius:50%;animation:spin .7s linear infinite}
.spinner-sm{display:inline-block;width:13px;height:13px;border:2px solid rgba(255,255,255,.15);border-top-color:#1877f2;border-radius:50%;animation:spin .6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.empty-state{text-align:center;padding:60px 20px;color:rgba(255,255,255,.3)}
.empty-state i{font-size:48px;margin-bottom:14px;display:block;color:rgba(255,255,255,.12)}
.empty-state h3{font-size:15px;font-weight:600;margin-bottom:6px;color:rgba(255,255,255,.5)}
.empty-state p{font-size:12.5px;line-height:1.65}
.quick-tags{display:flex;gap:7px;justify-content:center;flex-wrap:wrap;margin-top:18px}
.quick-tag{padding:6px 14px;border-radius:20px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);color:rgba(255,255,255,.55);font-size:12px;cursor:pointer;transition:.2s}
.quick-tag:hover{background:rgba(24,119,242,.12);border-color:rgba(24,119,242,.3);color:#60a5fa}
/* Saved */
.saved-list{display:flex;flex-direction:column;gap:8px}
.saved-row{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);border-radius:10px;padding:11px 14px;display:flex;align-items:center;gap:11px}
.saved-info{flex:1;min-width:0}
.saved-page{font-size:13px;font-weight:700}
.saved-text{font-size:11.5px;color:rgba(255,255,255,.45);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px}
.saved-actions{display:flex;gap:5px}
/* Modal */
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.78);z-index:200;display:flex;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(5px)}
.modal-bg.hidden{display:none}
.modal-box{background:#0f1630;border:1px solid rgba(255,255,255,.1);border-radius:16px;max-width:700px;width:100%;max-height:90vh;overflow-y:auto}
.modal-head{padding:16px 20px;border-bottom:1px solid rgba(255,255,255,.07);display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;background:#0f1630;z-index:1}
.modal-title{font-size:15px;font-weight:700}
.modal-close{background:none;border:none;color:rgba(255,255,255,.45);font-size:20px;cursor:pointer;border-radius:6px;padding:3px}
.modal-close:hover{color:#fff;background:rgba(255,255,255,.08)}
.modal-body{padding:20px}
.info-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px;margin-bottom:14px}
.info-chip{background:rgba(255,255,255,.05);border-radius:8px;padding:9px 12px}
.info-chip .lbl{font-size:10px;color:rgba(255,255,255,.3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:2px}
.info-chip .val{font-size:13px;font-weight:600}
.section-lbl{font-size:10.5px;font-weight:700;color:rgba(255,255,255,.3);text-transform:uppercase;letter-spacing:.8px;margin:14px 0 7px}
.content-box{font-size:13px;color:rgba(255,255,255,.75);line-height:1.65;background:rgba(255,255,255,.04);border-radius:8px;padding:11px;margin-bottom:7px}
/* Token modal */
.perm-steps{counter-reset:step;text-align:left;background:rgba(0,0,0,.2);border-radius:8px;padding:12px 16px;margin-bottom:14px}
.perm-steps li{font-size:12px;color:rgba(255,255,255,.6);margin-bottom:6px;list-style:none;display:flex;align-items:flex-start;gap:7px}
.perm-steps li::before{content:counter(step);counter-increment:step;background:#1877f2;color:#fff;border-radius:50%;width:18px;height:18px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;flex-shrink:0;margin-top:1px}
/* Permission notice */
.perm-notice{background:rgba(24,119,242,.06);border:1px solid rgba(24,119,242,.2);border-radius:12px;padding:24px;text-align:center;max-width:560px;margin:0 auto}
.perm-notice i{font-size:36px;color:#60a5fa;margin-bottom:12px;display:block}
.perm-notice h3{font-size:15px;font-weight:700;margin-bottom:8px;color:rgba(255,255,255,.85)}
.perm-notice p{font-size:12.5px;color:rgba(255,255,255,.5);line-height:1.65;margin-bottom:14px}
/* Toast */
.toast-wrap{position:fixed;bottom:22px;right:22px;z-index:999;display:flex;flex-direction:column;gap:7px}
.toast{background:#1e293b;border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:11px 15px;font-size:13px;display:flex;align-items:center;gap:9px;min-width:250px;animation:slideIn .3s;box-shadow:0 8px 24px rgba(0,0,0,.4)}
.toast.success{border-left:3px solid #22c55e}.toast.error{border-left:3px solid #ef4444}.toast.info{border-left:3px solid #60a5fa}
@keyframes slideIn{from{transform:translateX(110%);opacity:0}to{transform:translateX(0);opacity:1}}
.hidden{display:none!important}
</style>
</head>
<body>
<aside class="sidebar">
  <a href="index.html" class="sidebar-logo"><img src="images/logo.png" alt="Logo"><span>GENZ<em>TECH</em></span></a>
  <nav class="sidebar-nav">
    <div class="nav-group-label">T·ªïng quan</div>
    <a href="index.html" class="nav-item"><i class="bi bi-grid-1x2"></i> Dashboard</a>
    <div class="nav-group-label">C√¥ng c·ª•</div>
    <a href="auto-post.html" class="nav-item"><i class="bi bi-send-fill"></i> T·ª± ƒê·ªông ƒêƒÉng B√†i</a>
    <a href="ads-assistant.html" class="nav-item"><i class="bi bi-robot"></i> Tr·ª£ L√Ω Qu·∫£ng C√°o</a>
    <div class="nav-sub">
      <a href="tool-ad-account.html" class="nav-item"><i class="bi bi-shield-check"></i> Ki·ªÉm Tra TKQC</a>
      <a href="tool-fb-id.html" class="nav-item"><i class="bi bi-person-badge"></i> T√¨m Facebook ID</a>
      <a href="tool-budget.html" class="nav-item"><i class="bi bi-graph-up-arrow"></i> Ph√¢n T√≠ch Ng√¢n S√°ch</a>
      <a href="tool-translate.html" class="nav-item"><i class="bi bi-translate"></i> D·ªãch Thu·∫≠t</a>
      <a href="tool-ads-finder.html" class="nav-item active"><i class="bi bi-binoculars"></i> Ads Finder</a>
      <a href="tool-policy.html" class="nav-item"><i class="bi bi-journal-text"></i> Ch√≠nh S√°ch FB</a>
      <a href="tool-cookie.html" class="nav-item"><i class="bi bi-cookie"></i> Qu·∫£n L√Ω Cookie</a>
    </div>
    <div class="nav-group-label">H·ªá th·ªëng</div>
    <a href="#" class="nav-item"><i class="bi bi-gear"></i> C√†i ƒê·∫∑t</a>
  </nav>
</aside>

<div class="main-content">
  <header class="topbar">
    <div class="breadcrumb"><i class="bi bi-house"></i><i class="bi bi-chevron-right" style="font-size:10px"></i><span>Ads Finder</span></div>
    <div style="display:flex;gap:8px;align-items:center">
      <button class="btn btn-sm btn-outline" onclick="switchTab('saved')"><i class="bi bi-bookmark-fill"></i> ƒê√£ l∆∞u (<span id="savedCount">0</span>)</button>
      <a href="https://www.facebook.com/ads/library" target="_blank" class="btn btn-sm btn-primary"><i class="bi bi-box-arrow-up-right"></i> M·ªü Ads Library</a>
    </div>
  </header>

  <div class="search-section">
    <div class="search-row">
      <div class="adlib-badge"><i class="bi bi-meta"></i> Ad Library</div>
      <div class="search-wrap">
        <i class="bi bi-search search-icon"></i>
        <input type="text" class="search-input" id="searchInput" placeholder="T√¨m theo t·ª´ kh√≥a, t√™n trang, s·∫£n ph·∫©m..." onkeydown="if(event.key==='Enter')doSearch()">
      </div>
      <select class="sel" id="countrySelect">
        <option value="VN">üáªüá≥ Vietnam</option>
        <option value="ALL">üåç All countries</option>
        <option value="US">üá∫üá∏ United States</option>
        <option value="TH">üáπüá≠ Thailand</option>
        <option value="SG">üá∏üá¨ Singapore</option>
        <option value="MY">üá≤üáæ Malaysia</option>
        <option value="ID">üáÆüá© Indonesia</option>
        <option value="PH">üáµüá≠ Philippines</option>
        <option value="GB">üá¨üáß United Kingdom</option>
        <option value="AU">üá¶üá∫ Australia</option>
      </select>
      <select class="sel" id="adTypeSelect">
        <option value="all">All ads</option>
        <option value="political_and_issue_ads">Political &amp; Issue</option>
        <option value="housing_ads">Housing</option>
        <option value="employment_ads">Employment</option>
        <option value="credit_ads">Credit</option>
      </select>
      <button class="btn btn-primary" onclick="doSearch()" id="searchBtn"><i class="bi bi-search"></i> T√¨m ki·∫øm</button>
    </div>
  </div>

  <div class="filter-bar">
    <select class="sel" id="statusSelect">
      <option value="active">‚úÖ Active ads</option>
      <option value="inactive">‚è∏ Inactive ads</option>
      <option value="all">All status</option>
    </select>
    <select class="sel" id="mediaTypeSelect">
      <option value="all">All formats</option>
      <option value="image">üñº Image</option>
      <option value="video">üé¨ Video</option>
      <option value="meme">üìù Text only</option>
    </select>
    <div style="flex:1"></div>
    <span id="resultsInfo" style="font-size:12px;color:rgba(255,255,255,.35)"></span>
    <a id="libLink" href="https://www.facebook.com/ads/library" target="_blank" style="font-size:12px;color:#60a5fa;text-decoration:none;display:flex;align-items:center;gap:4px"><i class="bi bi-box-arrow-up-right"></i> Xem tr√™n Ads Library</a>
  </div>

  <div class="token-bar" id="tokenBar">
    <div style="display:flex;align-items:center;gap:8px;flex:1;flex-wrap:wrap">
      <i class="bi bi-key-fill" style="color:#eab308;font-size:15px;flex-shrink:0"></i>
      <span style="font-size:12.5px;color:rgba(255,255,255,.5);white-space:nowrap">Access Token:</span>
      <div style="flex:1;min-width:200px;position:relative">
        <input type="password" id="inlineTokenInput" placeholder="D√°n User Access Token (quy·ªÅn ads_read) v√†o ƒë√¢y..." style="width:100%;background:rgba(255,255,255,.06);border:1.5px solid rgba(255,255,255,.1);border-radius:8px;padding:7px 80px 7px 12px;color:#fff;font-size:12.5px;transition:all .2s" onfocus="this.style.borderColor='#1877f2'" onblur="this.style.borderColor='rgba(255,255,255,.1)'" onkeydown="if(event.key==='Enter')saveInlineToken()">
        <button onclick="toggleTokenVisibility()" style="position:absolute;right:38px;top:50%;transform:translateY(-50%);background:none;border:none;color:rgba(255,255,255,.35);cursor:pointer;font-size:14px;padding:2px"><i class="bi bi-eye" id="eyeIcon"></i></button>
        <button onclick="saveInlineToken()" style="position:absolute;right:6px;top:50%;transform:translateY(-50%);background:rgba(24,119,242,.2);border:none;border-radius:5px;color:#60a5fa;cursor:pointer;font-size:11px;font-weight:700;padding:3px 7px">L∆∞u</button>
      </div>
      <span id="tokenStatus" style="font-size:11.5px"></span>
    </div>
    <a href="https://developers.facebook.com/tools/explorer" target="_blank" style="font-size:11.5px;color:rgba(255,255,255,.35);text-decoration:none;white-space:nowrap;flex-shrink:0"><i class="bi bi-question-circle"></i> L·∫•y token</a>
  </div>

  <div class="content-area">
    <div class="tab-bar">
      <button class="tab-btn active" onclick="switchTab('results')" id="tab-results"><i class="bi bi-grid-3x3-gap"></i> K·∫øt qu·∫£</button>
      <button class="tab-btn" onclick="switchTab('saved')" id="tab-saved"><i class="bi bi-bookmark-fill"></i> ƒê√£ l∆∞u (<span id="savedCountTab">0</span>)</button>
    </div>

    <div class="tab-pane active" id="pane-results">
      <div class="empty-state" id="emptyState">
        <i class="bi bi-binoculars"></i>
        <h3>Kh√°m ph√° qu·∫£ng c√°o ƒë·ªëi th·ªß</h3>
        <p>T√¨m ki·∫øm qu·∫£ng c√°o ƒëang ch·∫°y t·ª´ b·∫•t k·ª≥ th∆∞∆°ng hi·ªáu n√†o.<br>D·ªØ li·ªáu th·∫≠t t·ª´ <strong style="color:#60a5fa">Facebook Ads Library API</strong>.</p>
        <div class="quick-tags">
          <span class="quick-tag" onclick="quickSearch('Shopee')">Shopee</span>
          <span class="quick-tag" onclick="quickSearch('Lazada')">Lazada</span>
          <span class="quick-tag" onclick="quickSearch('thoi trang')">Th·ªùi trang</span>
          <span class="quick-tag" onclick="quickSearch('my pham')">M·ªπ ph·∫©m</span>
          <span class="quick-tag" onclick="quickSearch('bat dong san')">B·∫•t ƒë·ªông s·∫£n</span>
          <span class="quick-tag" onclick="quickSearch('khoa hoc online')">Kh√≥a h·ªçc</span>
          <span class="quick-tag" onclick="quickSearch('nha hang')">Nh√† h√†ng</span>
          <span class="quick-tag" onclick="quickSearch('xe may')">Xe m√°y</span>
        </div>
      </div>
      <div class="spinner-wrap hidden" id="loadingState">
        <div class="spinner"></div>
        <span>ƒêang t·∫£i t·ª´ Facebook Ads Library API...</span>
      </div>
      <div class="ads-grid" id="adsGrid"></div>
      <div id="loadMoreWrap" style="text-align:center;margin-top:24px;display:none">
        <button class="btn btn-outline" onclick="loadMore()" id="loadMoreBtn"><i class="bi bi-arrow-down-circle"></i> T·∫£i th√™m</button>
      </div>
    </div>

    <div class="tab-pane" id="pane-saved">
      <div class="empty-state" id="savedEmpty">
        <i class="bi bi-bookmark"></i>
        <h3>Ch∆∞a c√≥ qu·∫£ng c√°o n√†o ƒë∆∞·ª£c l∆∞u</h3>
        <p>Nh·∫•n n√∫t <strong>L∆∞u</strong> tr√™n m·ªói qu·∫£ng c√°o ƒë·ªÉ l∆∞u v√†o ƒë√¢y.</p>
      </div>
      <div class="saved-list" id="savedList"></div>
      <div id="savedActions" style="margin-top:14px;gap:8px;display:none">
        <button class="btn btn-sm btn-outline" onclick="exportSaved()"><i class="bi bi-download"></i> Xu·∫•t CSV</button>
        <button class="btn btn-sm btn-danger" onclick="clearSaved()"><i class="bi bi-trash"></i> X√≥a t·∫•t c·∫£</button>
      </div>
    </div>
  </div>
</div>

<!-- Token Modal -->
<div class="modal-bg hidden" id="tokenModal" onclick="if(event.target===this)closeTokenModal()">
  <div class="modal-box" style="max-width:480px">
    <div class="modal-head">
      <span class="modal-title"><i class="bi bi-key-fill" style="color:#eab308"></i> Nh·∫≠p Access Token</span>
      <button class="modal-close" onclick="closeTokenModal()"><i class="bi bi-x-lg"></i></button>
    </div>
    <div class="modal-body">
      <p style="font-size:13px;color:rgba(255,255,255,.6);margin-bottom:14px;line-height:1.6">C·∫ßn User Access Token c√≥ quy·ªÅn <code style="background:rgba(255,255,255,.08);padding:1px 5px;border-radius:4px">ads_read</code> ƒë·ªÉ t√¨m ki·∫øm trong app.</p>
      <ol class="perm-steps">
        <li>V√†o <a href="https://developers.facebook.com/tools/explorer" target="_blank" style="color:#60a5fa">Graph API Explorer</a></li>
        <li>Ch·ªçn App c·ªßa b·∫°n, th√™m permission <strong>ads_read</strong></li>
        <li>Click <strong>Generate Access Token</strong> v√† copy token</li>
        <li>D√°n v√†o √¥ b√™n d∆∞·ªõi v√† nh·∫•n L∆∞u</li>
      </ol>
      <input type="password" id="tokenInput" placeholder="D√°n Access Token v√†o ƒë√¢y..." style="width:100%;background:rgba(255,255,255,.07);border:1.5px solid rgba(255,255,255,.12);border-radius:8px;padding:10px 14px;color:#fff;font-size:13px;margin-bottom:12px">
      <div style="display:flex;gap:8px">
        <button class="btn btn-primary" onclick="saveToken()" style="flex:1"><i class="bi bi-check-lg"></i> L∆∞u Token</button>
        <button class="btn btn-outline" onclick="closeTokenModal()">H·ªßy</button>
      </div>
      <p style="font-size:11px;color:rgba(255,255,255,.25);margin-top:10px;text-align:center">Token l∆∞u local trong tr√¨nh duy·ªát, kh√¥ng g·ª≠i l√™n server.</p>
    </div>
  </div>
</div>

<!-- Detail Modal -->
<div class="modal-bg hidden" id="detailModal" onclick="if(event.target===this)closeDetail()">
  <div class="modal-box">
    <div class="modal-head">
      <span class="modal-title" id="detailTitle">Chi ti·∫øt qu·∫£ng c√°o</span>
      <button class="modal-close" onclick="closeDetail()"><i class="bi bi-x-lg"></i></button>
    </div>
    <div class="modal-body" id="detailBody"></div>
  </div>
</div>

<div class="toast-wrap" id="toastWrap"></div>

<script>
const BACKEND='https://genztech-production.up.railway.app';
const TOKEN_KEY='gz_ads_finder_token';
let allAds=[],savedAds=JSON.parse(localStorage.getItem('gz_saved_ads')||'[]');
let cursor=null,lastQuery='',loading=false;

function getToken(){return localStorage.getItem(TOKEN_KEY)||localStorage.getItem('gz_manual_fb_token')||'';}
function checkBanner(){
  const token=getToken();
  const inp=document.getElementById('inlineTokenInput');
  const status=document.getElementById('tokenStatus');
  if(token){
    inp.value=token;
    status.innerHTML='<i class="bi bi-check-circle-fill" style="color:#4ade80"></i> <span style="color:#4ade80">ƒê√£ c√≥ token</span>';
  }else{
    status.innerHTML='<span style="color:rgba(255,255,255,.3)">Ch∆∞a c√≥ token</span>';
  }
}
function showTokenModal(){document.getElementById('tokenModal').classList.remove('hidden');}
function closeTokenModal(){document.getElementById('tokenModal').classList.add('hidden');}
function toggleTokenVisibility(){
  const inp=document.getElementById('inlineTokenInput');
  const icon=document.getElementById('eyeIcon');
  if(inp.type==='password'){inp.type='text';icon.className='bi bi-eye-slash';}
  else{inp.type='password';icon.className='bi bi-eye';}
}
function saveInlineToken(){
  const v=document.getElementById('inlineTokenInput').value.trim();
  if(!v){toast('Vui l√≤ng nh·∫≠p token','error');return;}
  localStorage.setItem(TOKEN_KEY,v);
  checkBanner();
  toast('ƒê√£ l∆∞u token','success');
}
function saveToken(){
  const v=document.getElementById('tokenInput').value.trim();
  if(!v){toast('Vui l√≤ng nh·∫≠p token','error');return;}
  localStorage.setItem(TOKEN_KEY,v);closeTokenModal();checkBanner();toast('ƒê√£ l∆∞u token','success');
}
function toast(msg,type='info'){
  const c=document.getElementById('toastWrap'),t=document.createElement('div');
  t.className='toast '+type;
  const ic={success:'check-circle-fill',error:'x-circle-fill',info:'info-circle-fill'};
  t.innerHTML='<i class="bi bi-'+(ic[type]||'info-circle-fill')+'"></i><span>'+msg+'</span>';
  c.appendChild(t);setTimeout(()=>{t.style.opacity='0';setTimeout(()=>t.remove(),300);},3500);
}
function initials(n){return n?n.split(' ').map(w=>w[0]).join('').toUpperCase().slice(0,2):'?';}
function isSaved(id){return savedAds.some(a=>a.id===id);}
function updateCounts(){const n=savedAds.length;document.getElementById('savedCount').textContent=n;document.getElementById('savedCountTab').textContent=n;}
function buildLibURL(q){
  const c=document.getElementById('countrySelect').value;
  const at=document.getElementById('adTypeSelect').value;
  const st=document.getElementById('statusSelect').value;
  return 'https://www.facebook.com/ads/library/?active_status='+(st==='all'?'all':st)+'&ad_type='+(at||'all')+'&country='+(c||'VN')+'&q='+encodeURIComponent(q||'')+'&search_type=keyword_unordered';
}
function quickSearch(kw){document.getElementById('searchInput').value=kw;doSearch();}
function doSearch(){
  const q=document.getElementById('searchInput').value.trim();
  if(!q){toast('Vui l√≤ng nh·∫≠p t·ª´ kh√≥a','error');return;}
  const token=getToken();
  if(!token){showTokenModal();return;}
  lastQuery=q;cursor=null;allAds=[];
  document.getElementById('adsGrid').innerHTML='';
  fetchAds(q,true);
}
function loadMore(){if(!lastQuery||loading)return;fetchAds(lastQuery,false);}
async function fetchAds(q,isNew){
  if(loading)return;loading=true;
  const token=getToken();
  const libURL=buildLibURL(q);
  document.getElementById('libLink').href=libURL;
  if(isNew){
    document.getElementById('emptyState').classList.add('hidden');
    document.getElementById('loadingState').classList.remove('hidden');
    document.getElementById('loadMoreWrap').style.display='none';
    document.getElementById('resultsInfo').textContent='';
    document.getElementById('searchBtn').innerHTML='<span class="spinner-sm"></span> ƒêang t√¨m...';
  }else{
    document.getElementById('loadMoreBtn').innerHTML='<span class="spinner-sm"></span> ƒêang t·∫£i...';
  }
  try{
    const resp=await fetch(BACKEND+'/api/facebook/ads-library',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({q,token,country:document.getElementById('countrySelect').value,adType:document.getElementById('adTypeSelect').value,status:document.getElementById('statusSelect').value,mediaType:document.getElementById('mediaTypeSelect').value,cursor}),
      signal:AbortSignal.timeout(25000)
    });
    const data=await resp.json();
    if(resp.status===403&&data.error==='ads_library_permission'){showPermNotice(q,libURL);return;}
    if(!resp.ok)throw new Error(data.error||'L·ªói server');
    const ads=data.ads||[];
    cursor=data.next_cursor||null;
    if(isNew)allAds=ads;else allAds=[...allAds,...ads];
    renderAds(ads,isNew);
    document.getElementById('resultsInfo').textContent=allAds.length+' qu·∫£ng c√°o';
    document.getElementById('loadMoreWrap').style.display=(cursor&&ads.length>0)?'block':'none';
    if(isNew&&ads.length===0)showNoResult(q,libURL);
  }catch(err){
    console.error(err);showFallback(q,libURL);
    toast('Kh√¥ng th·ªÉ t·∫£i. ƒêang chuy·ªÉn sang link tr·ª±c ti·∫øp.','info');
  }finally{
    loading=false;
    document.getElementById('loadingState').classList.add('hidden');
    document.getElementById('searchBtn').innerHTML='<i class="bi bi-search"></i> T√¨m ki·∫øm';
    document.getElementById('loadMoreBtn').innerHTML='<i class="bi bi-arrow-down-circle"></i> T·∫£i th√™m';
  }
}
function showPermNotice(q,libURL){
  document.getElementById('loadingState').classList.add('hidden');
  const el=document.getElementById('emptyState');el.classList.remove('hidden');
  el.innerHTML='<div class="perm-notice"><i class="bi bi-shield-lock-fill"></i><h3>App c·∫ßn ƒëƒÉng k√Ω quy·ªÅn Ads Library API</h3><p>Facebook y√™u c·∫ßu App ph·∫£i ƒëƒÉng k√Ω t·∫°i <strong>facebook.com/ads/library/api</strong>. Trong th·ªùi gian ch·ªù, b·∫°n c√≥ th·ªÉ xem tr·ª±c ti·∫øp tr√™n Facebook.</p><ol class="perm-steps" style="text-align:left;margin:0 auto 16px;max-width:360px"><li>V√†o <a href="https://www.facebook.com/ads/library/api" target="_blank" style="color:#60a5fa">facebook.com/ads/library/api</a></li><li>ƒêƒÉng nh·∫≠p v√† ƒëi·ªÅn form ƒëƒÉng k√Ω</li><li>Sau khi ƒë∆∞·ª£c duy·ªát (1-3 ng√†y), tool ho·∫°t ƒë·ªông ho√†n to√†n</li></ol><a href="'+libURL+'" target="_blank" class="btn btn-primary" style="margin:0 auto"><i class="bi bi-facebook"></i> Xem "'+q+'" tr√™n Ads Library</a></div>';
}
function showNoResult(q,libURL){
  const el=document.getElementById('emptyState');el.classList.remove('hidden');
  el.innerHTML='<i class="bi bi-search"></i><h3>Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£</h3><p>Kh√¥ng c√≥ qu·∫£ng c√°o n√†o kh·ªõp v·ªõi "<strong>'+q+'</strong>".</p><div style="margin-top:14px"><a href="'+libURL+'" target="_blank" class="btn btn-primary"><i class="bi bi-box-arrow-up-right"></i> T√¨m tr√™n Facebook Ads Library</a></div>';
}
function showFallback(q,libURL){
  const el=document.getElementById('emptyState');el.classList.remove('hidden');
  const c=document.getElementById('countrySelect').value;
  const brands=['Shopee','Lazada','Tiki','Grab','VinFast','Vinamilk'];
  el.innerHTML='<i class="bi bi-box-arrow-up-right" style="color:#1877f2"></i><h3 style="color:rgba(255,255,255,.7)">M·ªü tr·ª±c ti·∫øp tr√™n Facebook Ads Library</h3><p>Nh·∫•n b√™n d∆∞·ªõi ƒë·ªÉ xem "<strong>'+q+'</strong>" tr·ª±c ti·∫øp tr√™n Facebook.</p><div style="margin-top:16px"><a href="'+libURL+'" target="_blank" class="btn btn-primary"><i class="bi bi-facebook"></i> Xem tr√™n Ads Library</a></div><div class="quick-tags" style="margin-top:16px">'+brands.map(b=>'<a href="https://www.facebook.com/ads/library/?active_status=active&ad_type=all&country='+c+'&q='+encodeURIComponent(b)+'&search_type=keyword_unordered" target="_blank" class="quick-tag">'+b+'</a>').join('')+'</div>';
}
function renderAds(ads,isNew){
  const grid=document.getElementById('adsGrid');
  if(isNew)grid.innerHTML='';
  ads.forEach(ad=>{
    const saved=isSaved(ad.id);
    const isActive=ad.is_active!==false;
    const bodies=ad.ad_creative_bodies||[];
    const titles=ad.ad_creative_link_titles||[];
    const descs=ad.ad_creative_link_descriptions||[];
    const captions=ad.ad_creative_link_captions||[];
    const pfMap={facebook:'bi-facebook fb',instagram:'bi-instagram ig',whatsapp:'bi-whatsapp wa',messenger:'bi-messenger ms'};
    const platforms=(ad.publisher_platforms||['facebook']).map(p=>'<i class="bi '+(pfMap[p]||'bi-globe')+' pfi"></i>').join('');
    const startDate=ad.ad_delivery_start_time?new Date(ad.ad_delivery_start_time).toLocaleDateString('vi-VN'):'';
    const impr=ad.impressions?.lower_bound?Number(ad.impressions.lower_bound).toLocaleString('vi')+'+':'';
    const spend=ad.spend?.lower_bound?Number(ad.spend.lower_bound).toLocaleString('vi')+' '+(ad.currency||'USD')+'+':'';
    const card=document.createElement('div');
    card.className='ad-card';card.dataset.id=ad.id;
    card.innerHTML=
      '<div class="ad-card-top">'+
        '<div>'+
          '<span class="status-dot '+(isActive?'active':'inactive')+'">'+(isActive?'Active':'Inactive')+'</span>'+
          '<div class="ad-meta">ID: '+ad.id+(startDate?' ¬∑ '+startDate:'')+'</div>'+
          '<div class="platforms">'+platforms+'</div>'+
        '</div>'+
        '<button class="btn btn-sm btn-outline" style="padding:4px 9px;font-size:11px" onclick="openDetail(\''+ad.id+'\')"><i class="bi bi-info-circle"></i></button>'+
      '</div>'+
      (ad.snapshot_url?'<a href="'+ad.snapshot_url+'" target="_blank"><div class="ad-preview"><div class="preview-ph"><i class="bi bi-play-circle"></i><span>Xem qu·∫£ng c√°o</span></div><div class="preview-ov"><i class="bi bi-play-circle-fill"></i></div></div></a>':'<div class="ad-preview"><div class="preview-ph"><i class="bi bi-image"></i><span>Kh√¥ng c√≥ ·∫£nh</span></div></div>')+
      '<div class="ad-body">'+
        '<div class="page-row">'+
          '<div class="page-av">'+initials(ad.page_name)+'</div>'+
          '<div style="flex:1;min-width:0">'+
            '<div class="page-nm"><a href="https://www.facebook.com/'+(ad.page_id||'')+'" target="_blank">'+(ad.page_name||'Trang ·∫©n danh')+'</a></div>'+
            '<div class="page-sub">Sponsored</div>'+
          '</div>'+
        '</div>'+
        (bodies[0]?'<div class="ad-text">'+bodies[0].replace(/</g,'&lt;')+'</div>':'')+
        (titles[0]?'<div class="link-box">'+(captions[0]?'<div class="link-domain">'+captions[0]+'</div>':'')+'<div class="link-title">'+titles[0]+'</div>'+(descs[0]?'<div class="link-desc">'+descs[0]+'</div>':'')+'</div>':'')+
        ((impr||spend)?'<div class="ad-stats">'+(impr?'<span class="stat-chip"><strong>'+impr+'</strong> hi·ªÉn th·ªã</span>':'')+(spend?'<span class="stat-chip"><strong>'+spend+'</strong> chi ph√≠</span>':'')+'</div>':'')+
      '</div>'+
      '<div class="ad-footer">'+
        '<button class="adbtn adbtn-save'+(saved?' saved':'')+'" onclick="toggleSave(\''+ad.id+'\')"><i class="bi bi-bookmark'+(saved?'-fill':'')+'"></i> '+(saved?'ƒê√£ l∆∞u':'L∆∞u')+'</button>'+
        (ad.snapshot_url?'<a href="'+ad.snapshot_url+'" target="_blank" class="adbtn adbtn-view"><i class="bi bi-eye"></i> Xem QC</a>':'')+
        '<a href="https://www.facebook.com/ads/library/?id='+ad.id+'" target="_blank" class="adbtn adbtn-lib"><i class="bi bi-box-arrow-up-right"></i> Ads Lib</a>'+
      '</div>';
    grid.appendChild(card);
  });
}
function toggleSave(id){
  const ad=allAds.find(a=>a.id===id)||savedAds.find(a=>a.id===id);
  if(!ad)return;
  const idx=savedAds.findIndex(a=>a.id===id);
  if(idx>=0){savedAds.splice(idx,1);toast('ƒê√£ b·ªè l∆∞u','info');}
  else{savedAds.push({...ad,savedAt:new Date().toISOString()});toast('ƒê√£ l∆∞u qu·∫£ng c√°o','success');}
  localStorage.setItem('gz_saved_ads',JSON.stringify(savedAds));
  updateCounts();
  const btn=document.querySelector('.ad-card[data-id="'+id+'"] .adbtn-save');
  if(btn){const s=isSaved(id);btn.className='adbtn adbtn-save'+(s?' saved':'');btn.innerHTML='<i class="bi bi-bookmark'+(s?'-fill':'')+'"></i> '+(s?'ƒê√£ l∆∞u':'L∆∞u');}
  renderSavedList();
}
function renderSavedList(){
  const list=document.getElementById('savedList'),empty=document.getElementById('savedEmpty'),actions=document.getElementById('savedActions');
  if(!savedAds.length){empty.style.display='block';list.innerHTML='';actions.style.display='none';return;}
  empty.style.display='none';actions.style.display='flex';
  list.innerHTML=savedAds.map(ad=>
    '<div class="saved-row">'+
      '<div class="page-av" style="width:34px;height:34px;font-size:12px">'+initials(ad.page_name)+'</div>'+
      '<div class="saved-info"><div class="saved-page">'+(ad.page_name||'Trang ·∫©n danh')+'</div><div class="saved-text">'+((ad.ad_creative_bodies||[''])[0]||'Kh√¥ng c√≥ n·ªôi dung')+'</div></div>'+
      '<div class="saved-actions">'+
        (ad.snapshot_url?'<a href="'+ad.snapshot_url+'" target="_blank" class="btn btn-sm btn-outline" style="padding:5px 9px"><i class="bi bi-eye"></i></a>':'')+
        '<a href="https://www.facebook.com/ads/library/?id='+ad.id+'" target="_blank" class="btn btn-sm btn-outline" style="padding:5px 9px"><i class="bi bi-box-arrow-up-right"></i></a>'+
        '<button class="btn btn-sm btn-danger" style="padding:5px 9px" onclick="toggleSave(\''+ad.id+'\')"><i class="bi bi-trash"></i></button>'+
      '</div>'+
    '</div>'
  ).join('');
}
function clearSaved(){if(!confirm('X√≥a t·∫•t c·∫£ qu·∫£ng c√°o ƒë√£ l∆∞u?'))return;savedAds=[];localStorage.removeItem('gz_saved_ads');updateCounts();renderSavedList();toast('ƒê√£ x√≥a t·∫•t c·∫£','info');}
function exportSaved(){
  if(!savedAds.length)return;
  const rows=[['ID','Trang','N·ªôi dung','Ng√†y b·∫Øt ƒë·∫ßu','Link Ads Library','Ng√†y l∆∞u']];
  savedAds.forEach(ad=>rows.push([ad.id,ad.page_name||'',((ad.ad_creative_bodies||[''])[0]||'').replace(/"/g,'""'),ad.ad_delivery_start_time||'','https://www.facebook.com/ads/library/?id='+ad.id,ad.savedAt||'']));
  const csv=rows.map(r=>r.map(c=>'"'+c+'"').join(',')).join('\n');
  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob(['\uFEFF'+csv],{type:'text/csv;charset=utf-8'}));
  a.download='saved_ads_'+new Date().toISOString().slice(0,10)+'.csv';
  a.click();toast('ƒê√£ xu·∫•t CSV','success');
}
function openDetail(id){
  const ad=allAds.find(a=>a.id===id)||savedAds.find(a=>a.id===id);
  if(!ad)return;
  document.getElementById('detailTitle').textContent=ad.page_name||'Qu·∫£ng c√°o';
  const bodies=ad.ad_creative_bodies||[],titles=ad.ad_creative_link_titles||[],descs=ad.ad_creative_link_descriptions||[];
  const impr=ad.impressions?.lower_bound?Number(ad.impressions.lower_bound).toLocaleString('vi')+'+':'N/A';
  const spend=ad.spend?.lower_bound?Number(ad.spend.lower_bound).toLocaleString('vi')+' '+(ad.currency||'USD')+'+':'N/A';
  document.getElementById('detailBody').innerHTML=
    '<div class="info-grid">'+
      '<div class="info-chip"><div class="lbl">Library ID</div><div class="val">'+ad.id+'</div></div>'+
      '<div class="info-chip"><div class="lbl">Trang</div><div class="val">'+(ad.page_name||'N/A')+'</div></div>'+
      '<div class="info-chip"><div class="lbl">Tr·∫°ng th√°i</div><div class="val" style="color:'+(ad.is_active!==false?'#4ade80':'rgba(255,255,255,.4)')+'">'+(ad.is_active!==false?'ƒêang ch·∫°y':'ƒê√£ d·ª´ng')+'</div></div>'+
      '<div class="info-chip"><div class="lbl">B·∫Øt ƒë·∫ßu</div><div class="val">'+(ad.ad_delivery_start_time?new Date(ad.ad_delivery_start_time).toLocaleDateString('vi-VN'):'N/A')+'</div></div>'+
      '<div class="info-chip"><div class="lbl">L∆∞·ª£t hi·ªÉn th·ªã</div><div class="val">'+impr+'</div></div>'+
      '<div class="info-chip"><div class="lbl">Chi ph√≠</div><div class="val">'+spend+'</div></div>'+
    '</div>'+
    (bodies.length?'<div class="section-lbl">N·ªôi dung qu·∫£ng c√°o</div>'+bodies.map(b=>'<div class="content-box">'+b.replace(/</g,'&lt;').replace(/\n/g,'<br>')+'</div>').join(''):'')+
    (titles.length?'<div class="section-lbl">Ti√™u ƒë·ªÅ link</div><div class="content-box">'+titles.join('<br>')+'</div>':'')+
    (descs.length?'<div class="section-lbl">M√¥ t·∫£</div><div class="content-box" style="color:rgba(255,255,255,.55)">'+descs.join('<br>')+'</div>':'')+
    '<div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:16px">'+
      (ad.snapshot_url?'<a href="'+ad.snapshot_url+'" target="_blank" class="btn btn-primary"><i class="bi bi-eye"></i> Xem qu·∫£ng c√°o g·ªëc</a>':'')+
      '<a href="https://www.facebook.com/ads/library/?id='+ad.id+'" target="_blank" class="btn btn-outline"><i class="bi bi-box-arrow-up-right"></i> M·ªü trong Ads Library</a>'+
      '<button class="btn btn-outline" onclick="toggleSave(\''+ad.id+'\');closeDetail()"><i class="bi bi-bookmark'+(isSaved(ad.id)?'-fill':'')+'"></i> '+(isSaved(ad.id)?'B·ªè l∆∞u':'L∆∞u')+'</button>'+
    '</div>';
  document.getElementById('detailModal').classList.remove('hidden');
}
function closeDetail(){document.getElementById('detailModal').classList.add('hidden');}
function switchTab(tab){
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.tab-pane').forEach(p=>p.classList.remove('active'));
  const tb=document.getElementById('tab-'+tab),pb=document.getElementById('pane-'+tab);
  if(tb)tb.classList.add('active');if(pb)pb.classList.add('active');
  if(tab==='saved')renderSavedList();
}
checkBanner();updateCounts();
</script>
</body>
</html>

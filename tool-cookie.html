<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n L√Ω Cookie ‚Äî Genztech</title>
  <link rel="stylesheet" href="css/main.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    html,body{scrollbar-width:none;-ms-overflow-style:none;cursor:none}
    html::-webkit-scrollbar,body::-webkit-scrollbar{display:none;width:0}
    .app-layout{display:flex;min-height:100vh}
    .sidebar{width:260px;flex-shrink:0;background:rgba(10,14,39,.85);backdrop-filter:blur(20px);border-right:1px solid rgba(255,255,255,.06);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:40}
    .sidebar-logo{padding:20px 20px 16px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;gap:10px;text-decoration:none}
    .sidebar-logo img{width:36px;height:36px;border-radius:50%}
    .sidebar-logo span{font-size:15px;font-weight:700;letter-spacing:.5px;color:#fff}
    .sidebar-logo span em{color:#00d4ff;font-style:normal}
    .sidebar-nav{flex:1;padding:12px 0;overflow-y:auto}
    .nav-group-label{font-size:10px;font-weight:600;letter-spacing:1.2px;color:rgba(255,255,255,.3);text-transform:uppercase;padding:12px 20px 4px}
    .nav-item{display:flex;align-items:center;gap:10px;padding:10px 20px;font-size:13.5px;color:rgba(255,255,255,.6);text-decoration:none;transition:all .2s;border-left:2px solid transparent}
    .nav-item:hover{color:#fff;background:rgba(255,255,255,.04)}
    .nav-item.active{color:#00d4ff;background:rgba(0,212,255,.08);border-left-color:#00d4ff}
    .nav-item i{width:18px;text-align:center;font-size:15px}
    .nav-sub .nav-item{font-size:12.5px;padding:7px 20px 7px 36px}
    .main-content{margin-left:260px;flex:1;display:flex;flex-direction:column;min-height:100vh}
    .topbar{position:sticky;top:0;z-index:30;background:rgba(10,14,39,.85);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,.06);padding:0 28px;height:64px;display:flex;align-items:center;justify-content:space-between}
    .breadcrumb{font-size:13px;color:rgba(255,255,255,.4);display:flex;align-items:center;gap:6px}
    .breadcrumb span{color:#fff;font-weight:600}
    .btn-sm{padding:7px 16px;border-radius:8px;font-size:13px;font-weight:600;border:none;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:6px}
    .btn-primary{background:linear-gradient(135deg,#d97706,#f59e0b);color:#fff}
    .btn-primary:hover{opacity:.9;transform:translateY(-1px)}
    .btn-outline{background:transparent;color:rgba(255,255,255,.7);border:1px solid rgba(255,255,255,.15)}
    .btn-outline:hover{border-color:#f59e0b;color:#f59e0b}
    .page-body{padding:28px;flex:1}
    .page-title{font-size:22px;font-weight:700;margin-bottom:4px}
    .page-subtitle{font-size:13px;color:rgba(255,255,255,.45);margin-bottom:24px}
    .card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);border-radius:14px;overflow:hidden;margin-bottom:20px}
    .card-header{padding:16px 20px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between}
    .card-title{font-size:14px;font-weight:700;display:flex;align-items:center;gap:8px}
    .card-title i{color:#fbbf24}
    .card-body{padding:20px}
    .form-control{width:100%;background:rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:10px 14px;color:#fff;font-size:13.5px;transition:border-color .2s;box-sizing:border-box;font-family:inherit}
    .form-control:focus{outline:none;border-color:#f59e0b}
    .form-control::placeholder{color:rgba(255,255,255,.25)}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:20px}
    @media(max-width:900px){.grid-2{grid-template-columns:1fr}}
    @media(max-width:768px){.sidebar{display:none};.main-content{margin-left:0}}
    .cookie-item{background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.07);border-radius:10px;padding:14px 16px;margin-bottom:8px;transition:all .2s}
    .cookie-item:hover{border-color:rgba(245,158,11,.2)}
    .cookie-item.active-session{border-color:rgba(34,197,94,.3);background:rgba(34,197,94,.04)}
    .cookie-header{display:flex;align-items:center;gap:10px;margin-bottom:8px}
    .cookie-avatar{width:36px;height:36px;border-radius:50%;background:rgba(245,158,11,.15);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:#fbbf24;flex-shrink:0}
    .cookie-name{font-size:14px;font-weight:700;flex:1}
    .cookie-status{font-size:11px;padding:2px 8px;border-radius:12px;font-weight:600}
    .status-active{background:rgba(34,197,94,.15);color:#4ade80}
    .status-expired{background:rgba(239,68,68,.15);color:#f87171}
    .status-unknown{background:rgba(255,255,255,.07);color:rgba(255,255,255,.4)}
    .cookie-meta{display:flex;gap:12px;font-size:11.5px;color:rgba(255,255,255,.35);margin-bottom:10px}
    .cookie-value{font-size:11px;font-family:monospace;background:rgba(0,0,0,.3);border-radius:6px;padding:6px 10px;color:rgba(255,255,255,.4);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-bottom:10px}
    .cookie-actions{display:flex;gap:6px}
    .cookie-btn{padding:5px 12px;border-radius:6px;border:none;cursor:pointer;font-size:11.5px;font-weight:600;transition:all .15s;display:flex;align-items:center;gap:4px}
    .btn-activate{background:rgba(34,197,94,.15);color:#4ade80}
    .btn-activate:hover{background:rgba(34,197,94,.25)}
    .btn-copy{background:rgba(245,158,11,.15);color:#fbbf24}
    .btn-copy:hover{background:rgba(245,158,11,.25)}
    .btn-check{background:rgba(96,165,250,.15);color:#60a5fa}
    .btn-check:hover{background:rgba(96,165,250,.25)}
    .btn-delete{background:rgba(239,68,68,.1);color:#f87171}
    .btn-delete:hover{background:rgba(239,68,68,.2)}
    .cookie-textarea{width:100%;min-height:80px;background:rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:10px 14px;color:#fff;font-size:12px;font-family:monospace;resize:vertical;box-sizing:border-box;transition:border-color .2s;line-height:1.5}
    .cookie-textarea:focus{outline:none;border-color:#f59e0b}
    .cookie-textarea::placeholder{color:rgba(255,255,255,.2)}
    .info-box{background:rgba(245,158,11,.06);border:1px solid rgba(245,158,11,.15);border-radius:10px;padding:14px 16px;font-size:12.5px;color:rgba(255,255,255,.55);line-height:1.6;margin-bottom:16px}
    .info-box strong{color:#fbbf24}
    .tab-bar{display:flex;gap:4px;padding:4px;background:rgba(0,0,0,.3);border-radius:10px;margin-bottom:20px}
    .tab-btn{flex:1;padding:8px 12px;border:none;border-radius:7px;background:transparent;color:rgba(255,255,255,.5);font-size:12.5px;font-weight:600;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:5px}
    .tab-btn.active{background:rgba(245,158,11,.15);color:#fbbf24}
    .tab-pane{display:none}
    .tab-pane.active{display:block}
    .toast-container{position:fixed;bottom:24px;right:24px;z-index:999;display:flex;flex-direction:column;gap:8px}
    .toast{background:#1e293b;border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:12px 16px;font-size:13px;display:flex;align-items:center;gap:10px;min-width:260px;animation:slideIn .3s ease;box-shadow:0 8px 24px rgba(0,0,0,.4);transition:opacity .3s}
    .toast.success{border-left:3px solid #22c55e}.toast.error{border-left:3px solid #ef4444}.toast.info{border-left:3px solid #60a5fa}
    @keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
  </style>
</head>
<body class="bg-space-black text-white antialiased overflow-x-hidden">
  <canvas id="starfield-far" class="fixed inset-0 pointer-events-none z-0"></canvas>
  <canvas id="starfield-mid" class="fixed inset-0 pointer-events-none z-1"></canvas>
  <canvas id="starfield-near" class="fixed inset-0 pointer-events-none z-2"></canvas>
  <div id="custom-cursor" class="fixed pointer-events-none z-[100] opacity-0 transition-opacity duration-200 flex items-center justify-center transform -translate-x-1/2 -translate-y-1/2 will-change-transform">
    <img src="images/logo.png" alt="" class="w-10 h-10 object-cover rounded-full filter drop-shadow-[0_0_8px_rgba(0,212,255,0.8)] pointer-events-none">
  </div>
  <div class="toast-container" id="toastContainer"></div>

  <div class="app-layout relative z-10">
    <aside class="sidebar">
      <a href="index.html" class="sidebar-logo"><img src="images/logo.png" alt="Logo"><span>GENZ<em>TECH</em></span></a>
      <nav class="sidebar-nav">
        <div class="nav-group-label">T·ªïng quan</div>
        <a href="index.html" class="nav-item"><i class="bi bi-grid-1x2"></i> Dashboard</a>
        <div class="nav-group-label">C√¥ng c·ª•</div>
        <a href="auto-post.html" class="nav-item"><i class="bi bi-send-fill"></i> T·ª± ƒê·ªông ƒêƒÉng B√†i</a>
        <a href="ads-assistant.html" class="nav-item"><i class="bi bi-robot"></i> Tr·ª£ L√Ω Qu·∫£ng C√°o</a>
        <div class="nav-sub">
          <a href="tool-ad-account.html" class="nav-item"><i class="bi bi-shield-check"></i> Ki·ªÉm Tra TKQC</a>
          <a href="tool-fb-id.html" class="nav-item"><i class="bi bi-person-badge"></i> T√¨m Facebook ID</a>
          <a href="tool-budget.html" class="nav-item"><i class="bi bi-graph-up-arrow"></i> Ph√¢n T√≠ch Ng√¢n S√°ch</a>
          <a href="tool-translate.html" class="nav-item"><i class="bi bi-translate"></i> D·ªãch Thu·∫≠t</a>
          <a href="tool-ads-finder.html" class="nav-item"><i class="bi bi-binoculars"></i> Ads Finder</a>
          <a href="tool-policy.html" class="nav-item"><i class="bi bi-journal-text"></i> Ch√≠nh S√°ch FB</a>
          <a href="tool-cookie.html" class="nav-item active"><i class="bi bi-cookie"></i> Qu·∫£n L√Ω Cookie</a>
        </div>
        <div class="nav-group-label">H·ªá th·ªëng</div>
        <a href="#" class="nav-item"><i class="bi bi-gear"></i> C√†i ƒê·∫∑t</a>
      </nav>
    </aside>

    <div class="main-content">
      <header class="topbar">
        <div class="breadcrumb">
          <i class="bi bi-house"></i><i class="bi bi-chevron-right" style="font-size:10px"></i>
          <a href="ads-assistant.html" style="color:rgba(255,255,255,.4);text-decoration:none">Tr·ª£ L√Ω QC</a>
          <i class="bi bi-chevron-right" style="font-size:10px"></i><span>Qu·∫£n L√Ω Cookie</span>
        </div>
        <div style="display:flex;gap:10px">
          <button class="btn-sm btn-outline" onclick="exportAllCookies()"><i class="bi bi-download"></i> Xu·∫•t JSON</button>
          <label class="btn-sm btn-primary" style="cursor:pointer"><i class="bi bi-upload"></i> Nh·∫≠p JSON <input type="file" accept=".json" style="display:none" onchange="importCookies(this)"></label>
        </div>
      </header>

      <main class="page-body">
        <h1 class="page-title"><i class="bi bi-cookie" style="color:#fbbf24"></i> Qu·∫£n L√Ω Cookie Phi√™n</h1>
        <p class="page-subtitle">L∆∞u tr·ªØ, qu·∫£n l√Ω v√† ki·ªÉm tra cookie phi√™n ƒëƒÉng nh·∫≠p Facebook. H·ªó tr·ª£ nhi·ªÅu t√†i kho·∫£n c√πng l√∫c</p>

        <div class="info-box">
          <strong>‚ö†Ô∏è L∆∞u √Ω b·∫£o m·∫≠t:</strong> Cookie l√† th√¥ng tin ƒëƒÉng nh·∫≠p nh·∫°y c·∫£m. Ch·ªâ l∆∞u cookie c·ªßa t√†i kho·∫£n b·∫°n s·ªü h·ªØu. D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u <strong>ch·ªâ tr√™n tr√¨nh duy·ªát c·ªßa b·∫°n</strong> (localStorage), kh√¥ng g·ª≠i l√™n server.
        </div>

        <div class="tab-bar">
          <button class="tab-btn active" onclick="switchCookieTab('list')" id="tabList"><i class="bi bi-list-ul"></i> Danh S√°ch (<span id="cookieCount">0</span>)</button>
          <button class="tab-btn" onclick="switchCookieTab('add')" id="tabAdd"><i class="bi bi-plus-circle"></i> Th√™m Cookie</button>
          <button class="tab-btn" onclick="switchCookieTab('checker')" id="tabChecker"><i class="bi bi-shield-check"></i> Ki·ªÉm Tra Cookie</button>
        </div>

        <!-- List tab -->
        <div id="paneList" class="tab-pane active">
          <div style="display:flex;gap:10px;margin-bottom:16px">
            <input type="text" class="form-control" id="cookieSearch" placeholder="T√¨m theo t√™n t√†i kho·∫£n..." oninput="renderCookieList()" style="flex:1">
            <button class="btn-sm btn-outline" onclick="checkAllCookies()"><i class="bi bi-shield-check"></i> Ki·ªÉm tra t·∫•t c·∫£</button>
          </div>
          <div id="cookieList">
            <div style="text-align:center;padding:40px;color:rgba(255,255,255,.3)"><i class="bi bi-cookie" style="font-size:32px;display:block;margin-bottom:10px"></i>Ch∆∞a c√≥ cookie n√†o ƒë∆∞·ª£c l∆∞u</div>
          </div>
        </div>

        <!-- Add tab -->
        <div id="paneAdd" class="tab-pane">
          <div class="card">
            <div class="card-header"><div class="card-title"><i class="bi bi-plus-circle"></i> Th√™m Cookie M·ªõi</div></div>
            <div class="card-body">
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
                <div>
                  <label style="font-size:12px;font-weight:600;color:rgba(255,255,255,.6);display:block;margin-bottom:6px">T√™n t√†i kho·∫£n *</label>
                  <input type="text" class="form-control" id="newCookieName" placeholder="V√≠ d·ª•: T√†i kho·∫£n ch√≠nh, Shop ABC...">
                </div>
                <div>
                  <label style="font-size:12px;font-weight:600;color:rgba(255,255,255,.6);display:block;margin-bottom:6px">Ghi ch√∫</label>
                  <input type="text" class="form-control" id="newCookieNote" placeholder="M·ª•c ƒë√≠ch s·ª≠ d·ª•ng...">
                </div>
              </div>
              <div style="margin-bottom:14px">
                <label style="font-size:12px;font-weight:600;color:rgba(255,255,255,.6);display:block;margin-bottom:6px">Cookie Value *</label>
                <textarea class="cookie-textarea" id="newCookieValue" placeholder="D√°n cookie v√†o ƒë√¢y...&#10;&#10;C√°ch l·∫•y cookie: M·ªü Facebook ‚Üí F12 ‚Üí Application ‚Üí Cookies ‚Üí facebook.com ‚Üí Copy to√†n b·ªô ho·∫∑c ch·ªâ cookie 'c_user' v√† 'xs'"></textarea>
              </div>
              <div style="margin-bottom:14px">
                <label style="font-size:12px;font-weight:600;color:rgba(255,255,255,.6);display:block;margin-bottom:6px">User Agent (t√πy ch·ªçn)</label>
                <input type="text" class="form-control" id="newCookieUA" placeholder="Mozilla/5.0 ...">
              </div>
              <div style="display:flex;gap:10px">
                <button class="btn-sm btn-primary" onclick="addCookie()"><i class="bi bi-plus-circle"></i> L∆∞u Cookie</button>
                <button class="btn-sm btn-outline" onclick="clearAddForm()"><i class="bi bi-x-circle"></i> X√≥a form</button>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-title"><i class="bi bi-info-circle"></i> H∆∞·ªõng D·∫´n L·∫•y Cookie</div></div>
            <div class="card-body">
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
                <div style="background:rgba(0,0,0,.2);border-radius:10px;padding:14px">
                  <div style="font-size:13px;font-weight:700;margin-bottom:8px;color:#fbbf24">üñ•Ô∏è Tr√™n m√°y t√≠nh (Chrome)</div>
                  <ol style="font-size:12px;color:rgba(255,255,255,.5);padding-left:16px;line-height:1.8;margin:0">
                    <li>M·ªü facebook.com v√† ƒëƒÉng nh·∫≠p</li>
                    <li>Nh·∫•n F12 ‚Üí Application</li>
                    <li>Ch·ªçn Cookies ‚Üí https://www.facebook.com</li>
                    <li>T√¨m cookie <strong style="color:#fbbf24">c_user</strong> v√† <strong style="color:#fbbf24">xs</strong></li>
                    <li>Copy gi√° tr·ªã v√† d√°n v√†o √¥ tr√™n</li>
                  </ol>
                </div>
                <div style="background:rgba(0,0,0,.2);border-radius:10px;padding:14px">
                  <div style="font-size:13px;font-weight:700;margin-bottom:8px;color:#60a5fa">üîå D√πng Extension</div>
                  <div style="font-size:12px;color:rgba(255,255,255,.5);line-height:1.8">
                    C√†i extension <strong style="color:#60a5fa">Cookie-Editor</strong> ho·∫∑c <strong style="color:#60a5fa">EditThisCookie</strong> tr√™n Chrome ƒë·ªÉ export to√†n b·ªô cookie d·∫°ng JSON m·ªôt c√°ch d·ªÖ d√†ng h∆°n.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Checker tab -->
        <div id="paneChecker" class="tab-pane">
          <div class="card">
            <div class="card-header"><div class="card-title"><i class="bi bi-shield-check"></i> Ki·ªÉm Tra Cookie Nhanh</div></div>
            <div class="card-body">
              <div style="margin-bottom:14px">
                <label style="font-size:12px;font-weight:600;color:rgba(255,255,255,.6);display:block;margin-bottom:6px">D√°n cookie c·∫ßn ki·ªÉm tra</label>
                <textarea class="cookie-textarea" id="checkCookieInput" placeholder="D√°n cookie v√†o ƒë√¢y..."></textarea>
              </div>
              <button class="btn-sm btn-primary" onclick="quickCheckCookie()"><i class="bi bi-shield-check"></i> Ki·ªÉm Tra</button>
              <div id="quickCheckResult" style="margin-top:14px"></div>
            </div>
          </div>
        </div>

      </main>
    </div>
  </div>

  <script src="js/ads-shared.js"></script>
  <script>
  let cookies = JSON.parse(localStorage.getItem('genz_cookies') || '[]');

  function switchCookieTab(tab) {
    ['list','add','checker'].forEach(t => {
      document.getElementById('pane'+t.charAt(0).toUpperCase()+t.slice(1)).classList.toggle('active', t===tab);
      document.getElementById('tab'+t.charAt(0).toUpperCase()+t.slice(1)).classList.toggle('active', t===tab);
    });
    if (tab === 'list') renderCookieList();
  }

  function saveCookies() {
    localStorage.setItem('genz_cookies', JSON.stringify(cookies));
    document.getElementById('cookieCount').textContent = cookies.length;
  }

  function addCookie() {
    const name = document.getElementById('newCookieName').value.trim();
    const value = document.getElementById('newCookieValue').value.trim();
    const note = document.getElementById('newCookieNote').value.trim();
    const ua = document.getElementById('newCookieUA').value.trim();

    if (!name) { GZ.toast('Vui l√≤ng nh·∫≠p t√™n t√†i kho·∫£n', 'error'); return; }
    if (!value) { GZ.toast('Vui l√≤ng nh·∫≠p cookie value', 'error'); return; }

    // Extract c_user if possible
    const cUserMatch = value.match(/c_user[=:]\s*["']?(\d+)["']?/);
    const uid = cUserMatch ? cUserMatch[1] : null;

    cookies.unshift({
      id: Date.now().toString(),
      name,
      value,
      note,
      ua,
      uid,
      status: 'unknown',
      addedAt: Date.now(),
      lastChecked: null
    });
    saveCookies();
    clearAddForm();
    switchCookieTab('list');
    GZ.toast('ƒê√£ l∆∞u cookie!', 'success');
  }

  function clearAddForm() {
    ['newCookieName','newCookieValue','newCookieNote','newCookieUA'].forEach(id => document.getElementById(id).value = '');
  }

  function renderCookieList() {
    const query = document.getElementById('cookieSearch').value.toLowerCase();
    const filtered = cookies.filter(c => c.name.toLowerCase().includes(query) || (c.note || '').toLowerCase().includes(query));
    const container = document.getElementById('cookieList');
    document.getElementById('cookieCount').textContent = cookies.length;

    if (!filtered.length) {
      container.innerHTML = '<div style="text-align:center;padding:40px;color:rgba(255,255,255,.3)"><i class="bi bi-cookie" style="font-size:32px;display:block;margin-bottom:10px"></i>' + (query ? 'Kh√¥ng t√¨m th·∫•y cookie n√†o' : 'Ch∆∞a c√≥ cookie n√†o ƒë∆∞·ª£c l∆∞u') + '</div>';
      return;
    }

    container.innerHTML = filtered.map(c => {
      const statusClass = c.status === 'active' ? 'status-active' : c.status === 'expired' ? 'status-expired' : 'status-unknown';
      const statusText = c.status === 'active' ? '‚úÖ C√≤n s·ªëng' : c.status === 'expired' ? '‚ùå H·∫øt h·∫°n' : '‚ùì Ch∆∞a ki·ªÉm tra';
      const masked = c.value.length > 60 ? c.value.substring(0, 60) + '...' : c.value;
      const addedDate = new Date(c.addedAt).toLocaleDateString('vi-VN');
      const checkedDate = c.lastChecked ? new Date(c.lastChecked).toLocaleString('vi-VN') : 'Ch∆∞a ki·ªÉm tra';

      return `<div class="cookie-item ${c.status === 'active' ? 'active-session' : ''}" id="cookie_${c.id}">
        <div class="cookie-header">
          <div class="cookie-avatar">${c.name.charAt(0).toUpperCase()}</div>
          <div style="flex:1">
            <div class="cookie-name">${c.name}</div>
            ${c.note ? `<div style="font-size:11.5px;color:rgba(255,255,255,.35)">${c.note}</div>` : ''}
          </div>
          <span class="cookie-status ${statusClass}">${statusText}</span>
        </div>
        <div class="cookie-meta">
          ${c.uid ? `<span><i class="bi bi-person"></i> UID: ${c.uid}</span>` : ''}
          <span><i class="bi bi-calendar"></i> Th√™m: ${addedDate}</span>
          <span><i class="bi bi-clock"></i> Ki·ªÉm tra: ${checkedDate}</span>
        </div>
        <div class="cookie-value" title="${c.value}">${masked}</div>
        <div class="cookie-actions">
          <button class="cookie-btn btn-check" onclick="checkSingleCookie('${c.id}')"><i class="bi bi-shield-check"></i> Ki·ªÉm tra</button>
          <button class="cookie-btn btn-copy" onclick="copyCookie('${c.id}')"><i class="bi bi-clipboard"></i> Copy</button>
          <button class="cookie-btn btn-activate" onclick="activateCookie('${c.id}')"><i class="bi bi-lightning"></i> K√≠ch ho·∫°t</button>
          <button class="cookie-btn btn-delete" onclick="deleteCookie('${c.id}')"><i class="bi bi-trash"></i> X√≥a</button>
        </div>
      </div>`;
    }).join('');
  }

  async function checkSingleCookie(id) {
    const cookie = cookies.find(c => c.id === id);
    if (!cookie) return;

    GZ.toast('ƒêang ki·ªÉm tra cookie...', 'info');

    try {
      // Check cookie validity via backend
      const resp = await fetch(`${GZ.API}/api/facebook/check-cookie`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', ...GZ.authHeaders() },
        body: JSON.stringify({ cookie: cookie.value })
      });

      if (resp.ok) {
        const data = await resp.json();
        cookie.status = data.valid ? 'active' : 'expired';
        cookie.lastChecked = Date.now();
        if (data.uid) cookie.uid = data.uid;
        if (data.name) cookie.name = data.name;
        saveCookies();
        renderCookieList();
        GZ.toast(data.valid ? `Cookie c√≤n s·ªëng! UID: ${data.uid}` : 'Cookie ƒë√£ h·∫øt h·∫°n', data.valid ? 'success' : 'error');
      } else {
        // Fallback: check locally
        const hasValidFields = cookie.value.includes('c_user') || cookie.value.includes('xs') || cookie.value.length > 20;
        cookie.status = hasValidFields ? 'active' : 'expired';
        cookie.lastChecked = Date.now();
        saveCookies();
        renderCookieList();
        GZ.toast(hasValidFields ? 'Cookie c√≥ v·∫ª h·ª£p l·ªá (ki·ªÉm tra c·ª•c b·ªô)' : 'Cookie kh√¥ng h·ª£p l·ªá', hasValidFields ? 'success' : 'error');
      }
    } catch(e) {
      // Offline check
      const hasValidFields = cookie.value.includes('c_user') || cookie.value.includes('xs') || cookie.value.length > 20;
      cookie.status = hasValidFields ? 'active' : 'expired';
      cookie.lastChecked = Date.now();
      saveCookies();
      renderCookieList();
      GZ.toast('Ki·ªÉm tra offline: ' + (hasValidFields ? 'C√≥ v·∫ª h·ª£p l·ªá' : 'Kh√¥ng h·ª£p l·ªá'), 'info');
    }
  }

  async function checkAllCookies() {
    if (!cookies.length) { GZ.toast('Kh√¥ng c√≥ cookie n√†o', 'error'); return; }
    GZ.toast(`ƒêang ki·ªÉm tra ${cookies.length} cookie...`, 'info');
    for (const c of cookies) await checkSingleCookie(c.id);
    GZ.toast('ƒê√£ ki·ªÉm tra t·∫•t c·∫£!', 'success');
  }

  function copyCookie(id) {
    const cookie = cookies.find(c => c.id === id);
    if (!cookie) return;
    navigator.clipboard.writeText(cookie.value);
    GZ.toast('ƒê√£ copy cookie!', 'success');
  }

  function activateCookie(id) {
    const cookie = cookies.find(c => c.id === id);
    if (!cookie) return;
    // Store as active cookie for use in other tools
    localStorage.setItem('genz_active_cookie', JSON.stringify({ id: cookie.id, name: cookie.name, value: cookie.value }));
    GZ.toast(`ƒê√£ k√≠ch ho·∫°t cookie: ${cookie.name}`, 'success');
  }

  function deleteCookie(id) {
    if (!confirm('X√≥a cookie n√†y?')) return;
    cookies = cookies.filter(c => c.id !== id);
    saveCookies();
    renderCookieList();
    GZ.toast('ƒê√£ x√≥a cookie', 'info');
  }

  function exportAllCookies() {
    if (!cookies.length) { GZ.toast('Kh√¥ng c√≥ cookie n√†o', 'error'); return; }
    const blob = new Blob([JSON.stringify(cookies, null, 2)], { type: 'application/json' });
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `genztech_cookies_${Date.now()}.json`; a.click();
    GZ.toast('ƒê√£ xu·∫•t file JSON!', 'success');
  }

  function importCookies(input) {
    const file = input.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = e => {
      try {
        const imported = JSON.parse(e.target.result);
        if (Array.isArray(imported)) {
          const newCount = imported.filter(c => !cookies.find(ex => ex.id === c.id)).length;
          cookies = [...imported.filter(c => !cookies.find(ex => ex.id === c.id)), ...cookies];
          saveCookies();
          renderCookieList();
          GZ.toast(`ƒê√£ nh·∫≠p ${newCount} cookie m·ªõi!`, 'success');
        } else throw new Error('Invalid format');
      } catch(e) { GZ.toast('File kh√¥ng h·ª£p l·ªá', 'error'); }
    };
    reader.readAsText(file);
    input.value = '';
  }

  function quickCheckCookie() {
    const value = document.getElementById('checkCookieInput').value.trim();
    if (!value) { GZ.toast('Vui l√≤ng nh·∫≠p cookie', 'error'); return; }

    const checks = [];
    const cUser = value.match(/c_user[=:]\s*["']?(\d+)["']?/);
    const xs = value.match(/\bxs[=:]\s*["']?([^"',;\s]+)["']?/);
    const datr = value.match(/\bdatr[=:]\s*["']?([^"',;\s]+)["']?/);

    if (cUser) checks.push({ pass: true, label: 'c_user', detail: `UID: ${cUser[1]}` });
    else checks.push({ pass: false, label: 'c_user', detail: 'Kh√¥ng t√¨m th·∫•y ‚Äî cookie c√≥ th·ªÉ kh√¥ng h·ª£p l·ªá' });

    if (xs) checks.push({ pass: true, label: 'xs (session)', detail: 'T√¨m th·∫•y session token' });
    else checks.push({ pass: false, label: 'xs (session)', detail: 'Kh√¥ng t√¨m th·∫•y session token' });

    if (datr) checks.push({ pass: true, label: 'datr', detail: 'T√¨m th·∫•y browser fingerprint' });

    checks.push({ pass: value.length > 50, label: 'ƒê·ªô d√†i', detail: `${value.length} k√Ω t·ª± ${value.length > 50 ? '‚Äî ƒë·ªß d√†i' : '‚Äî qu√° ng·∫Øn'}` });

    const isValid = cUser && xs;
    document.getElementById('quickCheckResult').innerHTML = `
      <div style="font-size:13px;font-weight:700;margin-bottom:10px;color:${isValid?'#4ade80':'#f87171'}">
        ${isValid ? '‚úÖ Cookie c√≥ v·∫ª h·ª£p l·ªá' : '‚ùå Cookie kh√¥ng ƒë·∫ßy ƒë·ªß'}
      </div>` +
      checks.map(c => `
        <div style="background:rgba(0,0,0,.2);border-radius:8px;padding:8px 12px;margin-bottom:5px;display:flex;align-items:center;gap:8px;font-size:12.5px;border-left:3px solid ${c.pass?'#22c55e':'#ef4444'}">
          <span>${c.pass?'‚úÖ':'‚ùå'}</span>
          <div><strong>${c.label}</strong>: ${c.detail}</div>
        </div>`).join('') +
      (isValid ? `<button class="btn-sm btn-primary" style="margin-top:10px" onclick="document.getElementById('newCookieValue').value=document.getElementById('checkCookieInput').value;switchCookieTab('add');GZ.toast('ƒê√£ chuy·ªÉn sang form th√™m cookie','info')"><i class='bi bi-plus-circle'></i> L∆∞u cookie n√†y</button>` : '');
  }

  document.addEventListener('DOMContentLoaded', () => { renderCookieList(); document.getElementById('cookieCount').textContent = cookies.length; });
  </script>
  <script>
  const isMobile=window.innerWidth<768;const cursor=document.getElementById('custom-cursor');if(cursor&&!('ontouchstart' in window)){let m=false;document.addEventListener('mousemove',e=>{cursor.style.left=e.clientX+'px';cursor.style.top=e.clientY+'px';if(!m){cursor.style.opacity='1';m=true;}});document.addEventListener('mouseleave',()=>{cursor.style.opacity='0';m=false;});}
  const cF=document.getElementById('starfield-far'),cM=document.getElementById('starfield-mid'),cN=document.getElementById('starfield-near');[cF,cM,cN].forEach(c=>{c.width=window.innerWidth;c.height=window.innerHeight;});window.addEventListener('resize',()=>{[cF,cM,cN].forEach(c=>{c.width=window.innerWidth;c.height=window.innerHeight;});});const xF=cF.getContext('2d'),xM=cM.getContext('2d'),xN=cN.getContext('2d');const sF=Array.from({length:isMobile?60:120},()=>({x:Math.random()*cF.width,y:Math.random()*cF.height,r:Math.random()*1+.3,o:Math.random()*.5+.1}));const sM=Array.from({length:isMobile?30:60},()=>({x:Math.random()*cM.width,y:Math.random()*cM.height,r:Math.random()*1.5+.5,o:Math.random()*.4+.1,vx:(Math.random()-.5)*.15,vy:(Math.random()-.5)*.15}));const sN=Array.from({length:isMobile?15:30},()=>({x:Math.random()*cN.width,y:Math.random()*cN.height,r:Math.random()*2+1,o:Math.random()*.6+.2,vx:(Math.random()-.5)*.3,vy:(Math.random()-.5)*.3,p:Math.random()*Math.PI*2}));const ss=[];let lt=0;function SS(){this.reset=()=>{this.x=Math.random()*cF.width*.7;this.y=Math.random()*cF.height*.3;this.len=Math.random()*80+40;this.spd=Math.random()*4+2;this.sz=Math.random()*1.5+.5;this.vx=this.spd;this.vy=this.spd*.5;this.op=0;this.life=0;this.maxLife=200;this.active=true;};this.update=()=>{this.x+=this.vx;this.y+=this.vy;this.life++;if(this.life<20)this.op=this.life/20;else if(this.life>this.maxLife-40)this.op=(this.maxLife-this.life)/40;else this.op=1;if(this.life>=this.maxLife||this.x>cF.width+300)this.active=false;};this.draw=c=>{if(!this.active)return;const tx=this.x-this.vx*(this.len/this.spd),ty=this.y-this.vy*(this.len/this.spd);const g=c.createLinearGradient(this.x,this.y,tx,ty);g.addColorStop(0,'rgba(255,255,255,'+this.op+')');g.addColorStop(1,'rgba(255,255,255,0)');c.strokeStyle=g;c.lineWidth=this.sz;c.lineCap='round';c.beginPath();c.moveTo(this.x,this.y);c.lineTo(tx,ty);c.stroke();};this.reset();}
  (function a(){xF.clearRect(0,0,cF.width,cF.height);sF.forEach(s=>{xF.fillStyle='rgba(255,255,255,'+s.o+')';xF.beginPath();xF.arc(s.x,s.y,s.r,0,Math.PI*2);xF.fill();});const now=Date.now();if(now-lt>Math.random()*1000+500&&ss.length<5){ss.push(new SS());lt=now;}xM.clearRect(0,0,cM.width,cM.height);for(let i=ss.length-1;i>=0;i--){ss[i].update();ss[i].draw(xM);if(!ss[i].active)ss.splice(i,1);}sM.forEach(s=>{s.x+=s.vx;s.y+=s.vy;if(s.x<0)s.x=cM.width;if(s.x>cM.width)s.x=0;if(s.y<0)s.y=cM.height;if(s.y>cM.height)s.y=0;xM.fillStyle='rgba(255,255,255,'+s.o+')';xM.beginPath();xM.arc(s.x,s.y,s.r,0,Math.PI*2);xM.fill();});xN.clearRect(0,0,cN.width,cN.height);sN.forEach(s=>{s.x+=s.vx;s.y+=s.vy;s.p+=.02;if(s.x<0)s.x=cN.width;if(s.x>cN.width)s.x=0;if(s.y<0)s.y=cN.height;if(s.y>cN.height)s.y=0;const po=s.o*(0.7+Math.sin(s.p)*.3);const g=xN.createRadialGradient(s.x,s.y,0,s.x,s.y,s.r*3);g.addColorStop(0,'rgba(217,119,6,'+po+')');g.addColorStop(.5,'rgba(245,158,11,'+(po*.5)+')');g.addColorStop(1,'rgba(245,158,11,0)');xN.fillStyle=g;xN.beginPath();xN.arc(s.x,s.y,s.r*3,0,Math.PI*2);xN.fill();});requestAnimationFrame(a);})();
  </script>
</body>
</html>
